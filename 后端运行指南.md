# Pocket åç«¯è¿è¡ŒæŒ‡å—

## ğŸ“‹ åç«¯æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: FastAPI 0.110.0 + Python 3.11
- **æ•°æ®åº“**: MySQL 8.0
- **ORM**: SQLAlchemy 2.0.29
- **æœåŠ¡å™¨**: Uvicorn
- **æ•°æ®åº“åœ°å€**: `192.168.31.11:3306`
- **æ•°æ®åº“å**: `pocket`
- **APIç«¯å£**: `8000`

## ğŸš€ å¦‚ä½•è¿è¡Œåç«¯

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ conda è™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰

#### 1ï¸âƒ£ é¦–æ¬¡è¿è¡Œ - è®¾ç½®ç¯å¢ƒ

**Linux/Mac:**
```bash
cd backend
bash setup_conda.sh
```

**Windows:**
```bash
cd backend
setup_conda.bat
```

è¿™ä¼šåˆ›å»ºä¸€ä¸ªåä¸º `pocket-backend` çš„ conda è™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…æ‰€æœ‰ä¾èµ–ã€‚

#### 2ï¸âƒ£ å¯åŠ¨åç«¯æœåŠ¡

**Linux/Mac:**
```bash
cd backend
bash start_server.sh
```

**Windows:**
```bash
cd backend
start_server.bat
```

### æ–¹æ³•äºŒï¼šå¿«é€Ÿå¯åŠ¨ï¼ˆå·²é…ç½®å¥½ç¯å¢ƒï¼‰

å¦‚æœä½ å·²ç»å®‰è£…å¥½äº† Python å’Œä¾èµ–ï¼Œå¯ä»¥ç›´æ¥è¿è¡Œï¼š

```bash
cd backend

# è®¾ç½®ç¯å¢ƒå˜é‡
export DATABASE_URL=mysql+pymysql://root:123456@192.168.31.11:3306/pocket
export UPLOAD_DIR=./data/uploads

# å¯åŠ¨æœåŠ¡ï¼ˆLinux/Macï¼‰
python -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

# Windows å¦‚æœä¸Šé¢çš„å‘½ä»¤ä¸è¡Œï¼Œç”¨è¿™ä¸ªï¼š
python -m uvicorn app.main:app --reload --host 127.0.0.1 --port 8000
```

### æ–¹æ³•ä¸‰ï¼šä½¿ç”¨æœ¬åœ°è„šæœ¬ï¼ˆè¿æ¥å¤–éƒ¨æ•°æ®åº“ï¼‰

**Linux/Mac:**
```bash
cd backend
bash run_local.sh
```

**Windows:**
```bash
cd backend
run_local.bat
```

## ğŸ“Œ é‡è¦æç¤º

### âš ï¸ å‰ç½®æ¡ä»¶

1. **MySQL æ•°æ®åº“å¿…é¡»è¿è¡Œ**
   - åœ°å€: `192.168.31.11:3306`
   - ç”¨æˆ·å: `root`
   - å¯†ç : `123456`
   - æ•°æ®åº“å: `pocket`

2. **é¦–æ¬¡è¿è¡Œéœ€è¦åˆå§‹åŒ–æ•°æ®åº“**
   ```bash
   mysql -h 192.168.31.11 -u root -p123456 pocket < ../docker/init.sql
   ```

### ğŸŒ è®¿é—®åœ°å€

å¯åŠ¨æˆåŠŸåï¼Œä½ å¯ä»¥è®¿é—®ï¼š

- **API æœåŠ¡**: http://localhost:8000
- **API æ–‡æ¡£**: http://localhost:8000/docs
- **å¥åº·æ£€æŸ¥**: http://localhost:8000/health
- **ReDoc æ–‡æ¡£**: http://localhost:8000/redoc

## ğŸ”§ å¸¸è§é—®é¢˜

### é—®é¢˜1: ç«¯å£ 8000 è¢«å ç”¨

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ¢ä¸ªç«¯å£
python -m uvicorn app.main:app --reload --host 127.0.0.1 --port 8001
```

### é—®é¢˜2: æ•°æ®åº“è¿æ¥å¤±è´¥

**æ£€æŸ¥é¡¹**:
- MySQL æœåŠ¡æ˜¯å¦å¯åŠ¨
- IP åœ°å€ `192.168.31.11` æ˜¯å¦æ­£ç¡®
- æ•°æ®åº“ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®
- æ•°æ®åº“ `pocket` æ˜¯å¦å·²åˆ›å»º

### é—®é¢˜3: ä¾èµ–å®‰è£…å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ‰‹åŠ¨å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å¦‚æœé‡åˆ° pymysql é—®é¢˜
pip install pymysql cryptography

# å¦‚æœä½¿ç”¨ conda
conda install -n pocket-backend pymysql cryptography
```

### é—®é¢˜4: Python ç‰ˆæœ¬ä¸å…¼å®¹

**è¦æ±‚**: Python 3.11

**æ£€æŸ¥ç‰ˆæœ¬**:
```bash
python --version
```

**å¦‚æœç‰ˆæœ¬ä¸å¯¹ï¼Œå®‰è£… Python 3.11**:
```bash
# ä½¿ç”¨ conda
conda create -n pocket-backend python=3.11 -y
conda activate pocket-backend
```

### é—®é¢˜5: Windows ä¸‹æƒé™é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ä½¿ç”¨ PowerShell ç®¡ç†å‘˜æƒé™è¿è¡Œ
# æˆ–è€…ä½¿ç”¨ Git Bash
```

## ğŸ“‚ åç«¯ä»£ç ç»“æ„

```
backend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py              # FastAPI åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ config.py        # åº”ç”¨é…ç½®ï¼ˆæ•°æ®åº“URLã€ä¸Šä¼ ç›®å½•ç­‰ï¼‰
â”‚   â”‚   â””â”€â”€ database.py      # æ•°æ®åº“è¿æ¥é…ç½®
â”‚   â””â”€â”€ models/              # æ•°æ®æ¨¡å‹
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ resource.py      # èµ„æºæ¨¡å‹
â”‚       â”œâ”€â”€ category.py      # åˆ†ç±»æ¨¡å‹
â”‚       â””â”€â”€ tag.py           # æ ‡ç­¾æ¨¡å‹
â”œâ”€â”€ alembic/                 # æ•°æ®åº“è¿ç§»å·¥å…·ç›®å½•
â”‚   â”œâ”€â”€ env.py
â”‚   â””â”€â”€ script.py.mako
â”œâ”€â”€ alembic.ini             # Alembic é…ç½®æ–‡ä»¶
â”œâ”€â”€ requirements.txt        # Python ä¾èµ–åŒ…åˆ—è¡¨
â”œâ”€â”€ environment.yml         # Conda ç¯å¢ƒé…ç½®æ–‡ä»¶
â”œâ”€â”€ Dockerfile              # Docker é•œåƒæ„å»ºæ–‡ä»¶
â”œâ”€â”€ start_server.sh        # Linux/Mac å¯åŠ¨è„šæœ¬
â”œâ”€â”€ start_server.bat       # Windows å¯åŠ¨è„šæœ¬
â”œâ”€â”€ run_local.sh           # æœ¬åœ°å¼€å‘å¯åŠ¨è„šæœ¬
â”œâ”€â”€ run_local.bat          # Windows æœ¬åœ°å¯åŠ¨è„šæœ¬
â”œâ”€â”€ setup_conda.sh         # Linux/Mac ç¯å¢ƒè®¾ç½®è„šæœ¬
â”œâ”€â”€ setup_conda.bat        # Windows ç¯å¢ƒè®¾ç½®è„šæœ¬
â”œâ”€â”€ init_db.sh             # Linux/Mac æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â””â”€â”€ init_db.bat            # Windows æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
```

## ğŸ”Œ ä¸»è¦ä¾èµ–åŒ…

```
fastapi==0.110.0              # Web æ¡†æ¶
uvicorn[standard]==0.28.0     # ASGI æœåŠ¡å™¨
sqlalchemy==2.0.29            # ORM
pymysql==1.1.0                # MySQL é©±åŠ¨
pydantic==2.6.4                # æ•°æ®éªŒè¯
python-multipart==0.0.9        # æ–‡ä»¶ä¸Šä¼ æ”¯æŒ
aiofiles==23.2.1              # å¼‚æ­¥æ–‡ä»¶æ“ä½œ
alembic==1.13.1                # æ•°æ®åº“è¿ç§»
python-jose[cryptography]==3.3.0  # JWT å¤„ç†
passlib[bcrypt]==1.7.4         # å¯†ç å“ˆå¸Œ
```

## âš™ï¸ ç¯å¢ƒå˜é‡é…ç½®

åç«¯æ”¯æŒé€šè¿‡ `.env` æ–‡ä»¶é…ç½®ç¯å¢ƒå˜é‡ï¼š

```env
DATABASE_URL=mysql+pymysql://username:password@host:port/database
UPLOAD_DIR=/path/to/uploads
```

é»˜è®¤é…ç½®ï¼ˆ`app/core/config.py`ï¼‰:
```python
DATABASE_URL = "mysql+pymysql://root:123456@192.168.31.11:3306/pocket"
UPLOAD_DIR = "/data/uploads"
```

## ğŸ—„ï¸ æ•°æ®åº“åˆå§‹åŒ–

### é¦–æ¬¡è¿è¡Œ

1. **åˆ›å»ºæ•°æ®åº“**ï¼ˆå¦‚æœè¿˜æ²¡åˆ›å»ºï¼‰:
   ```bash
   mysql -h 192.168.31.11 -u root -p123456
   CREATE DATABASE pocket;
   ```

2. **åˆå§‹åŒ–æ•°æ®åº“ç»“æ„**:
   ```bash
   mysql -h 192.168.31.11 -u root -p123456 pocket < ../docker/init.sql
   ```

3. **è¿è¡Œæ•°æ®åº“è¿ç§»**ï¼ˆå¦‚æœä½¿ç”¨ Alembicï¼‰:
   ```bash
   cd backend
   conda activate pocket-backend  # æˆ–ä½¿ç”¨ä½ çš„è™šæ‹Ÿç¯å¢ƒ
   alembic upgrade head
   ```

## ğŸ“Š API ç«¯ç‚¹

### åŸºç¡€ç«¯ç‚¹

- `GET /` - æ¬¢è¿ä¿¡æ¯
- `GET /health` - å¥åº·æ£€æŸ¥

### API æ–‡æ¡£

- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

## ğŸ”¥ å¼€å‘æ¨¡å¼ç‰¹æ€§

- **çƒ­é‡è½½**: ä»£ç ä¿®æ”¹åè‡ªåŠ¨é‡å¯æœåŠ¡å™¨
- **è‡ªåŠ¨æ–‡æ¡£**: è‡ªåŠ¨ç”Ÿæˆäº¤äº’å¼ API æ–‡æ¡£
- **CORS æ”¯æŒ**: å·²é…ç½®è·¨åŸŸèµ„æºå…±äº«
- **ç±»å‹æç¤º**: ä½¿ç”¨ Python ç±»å‹æç¤ºï¼Œä»£ç æ›´å®‰å…¨

## ğŸ³ Docker éƒ¨ç½²ï¼ˆå¯é€‰ï¼‰

å¦‚æœä½¿ç”¨ Dockerï¼š

```bash
# æ„å»ºé•œåƒ
docker build -t pocket-backend .

# è¿è¡Œå®¹å™¨
docker run -p 8000:8000 \
  -e DATABASE_URL=mysql+pymysql://root:123456@192.168.31.11:3306/pocket \
  pocket-backend
```

## ğŸ“ å¼€å‘å»ºè®®

1. **ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ**: é¿å…æ±¡æŸ“ç³»ç»Ÿ Python ç¯å¢ƒ
2. **å®šæœŸå¤‡ä»½æ•°æ®åº“**: é˜²æ­¢æ•°æ®ä¸¢å¤±
3. **ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶**: Git ç®¡ç†ä»£ç 
4. **ç¼–å†™æµ‹è¯•**: ä½¿ç”¨ pytest ç¼–å†™å•å…ƒæµ‹è¯•
5. **æŸ¥çœ‹æ—¥å¿—**: æ³¨æ„æ§åˆ¶å°è¾“å‡ºçš„é”™è¯¯ä¿¡æ¯

## ğŸ†˜ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æ£€æŸ¥ Python ç‰ˆæœ¬ï¼ˆéœ€è¦ 3.11ï¼‰
2. æ£€æŸ¥æ•°æ®åº“è¿æ¥
3. æŸ¥çœ‹é”™è¯¯æ—¥å¿—
4. ç¡®è®¤æ‰€æœ‰ä¾èµ–å·²å®‰è£…

---

**æœ€åæ›´æ–°**: 2024-01-20
**ç‰ˆæœ¬**: v1.0
